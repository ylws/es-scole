"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l])}return t},_createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var l=i[e];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(i,e,l){return e&&t(i.prototype,e),l&&t(i,l),i}}(),CFCMScole=function(){function t(i){_classCallCheck(this,t),this.initVal(i)}return _createClass(t,[{key:"getId",value:function(t){return document.getElementById(t)}},{key:"getClassAll",value:function(t){return document.querySelectorAll(t)}},{key:"remove",value:function(t){var i=t.parentNode;i&&i.removeChild(t)}},{key:"parents",value:function(t,i){return t.className==i?t:(t=t.parentNode,this.parents(t,i))}},{key:"initVal",value:function(t,i){var e={starid:"star0",star:".star",starbg:".starbg",init:{starnum:5,wid:0,val:0,totalscole:100,totalwid:100},callback:!1,disabled:!1,type:"auto",backgroundsize:!1};this.cfg={},_extends(this.cfg,e,t),this.initCommonVal()}},{key:"initCommonVal",value:function(t){var i=this;if(this.cfg.moveflag=!1,0==this.getClassAll(this.cfg.star).length)return console.log("该页面没有评分项"),!1;var e=0;t?(this.cfg=_extends(this.cfg,t),this.cfg.init.wid=t.init.wid,this.cfg.init.val=t.init.val,this.cfg.init.starnum=t.init.starnum,e=t.init.totalwid/t.init.starnum):(void 0==this.cfg.init.wid?this.cfg.init.wid=0:this.cfg.init.wid=this.cfg.init.wid,void 0==this.cfg.init.val?this.cfg.init.val=0:this.cfg.init.val=this.cfg.init.val,void 0==this.cfg.init.starnum?this.cfg.init.starnum=5:this.cfg.init.starnum=this.cfg.init.starnum,e=this.cfg.init.totalwid/this.cfg.init.starnum);var l=this.getId(this.cfg.starid);if(l){var a=l.querySelector(i.cfg.starbg);if(this.cfg.backgroundsize?(l.setAttribute("style","width:"+i.cfg.init.totalwid+"px;background-size:"+e+"px "),a.setAttribute("style","width:"+i.cfg.init.wid+"px;background-size:"+e+"px ")):(l.setAttribute("style","width:"+i.cfg.init.totalwid+"px"),a.setAttribute("style","width:"+i.cfg.init.wid+"px")),this.cfg.disabled)return l.onmousedown=null,!1;navigator.userAgent.match(/(iPhone|Android|iPad|Mobile|uc)/i)?(i.cfg.PstarbgObj=a,i.cfg.Pstarwid=e,i.cfg.Pitem=l,l.addEventListener("touchstart",function(){i.touchStart(i)},!1),l.addEventListener("touchmove",function(){i.touchMove(i)},!1),l.addEventListener("touchend",function(){i.touchEnd(i)},!1)):i.pcEvent(l,a,e),"function"==typeof i.cfg.callback&&i.cfg.callback(i.cfg.init,i)}}},{key:"getStyle",value:function(t,i){return window.getComputedStyle?window.getComputedStyle(t,null)[i]:t.currentStyle[i]}},{key:"getoffset",value:function(t,i){if(null==t)return i;i||((i={}).top=0,i.left=0);var e=this.getStyle(t,"position");if("absolute"==e||"relative"==e){if(t.getBoundingClientRect&&null!=navigator.userAgent.toLowerCase().match(/.(msie)/))return i.top+=t.getBoundingClientRect.top,i.left+=t.getBoundingClientRect.left,i;i.top+=t.offsetTop,i.left+=t.offsetLeft}else i.top+=0,i.left+=0;return this.getoffset(t.parentElement,i)}},{key:"pcEvent",value:function(t,i,e){var l=this,a=this.cfg;t.onmousedown=function(t){a.moveflag=!1;var n=window.event||t,o=(n.pageX||n.clientX,0),s=l.getoffset(this).left,c=a.init.totalwid,d=a.init.totalwid/a.init.totalscole;a.init.wid;a.scoleval=0,document.onmousemove=function(t){a.moveflag=!0;var n=window.event||t;n.preventDefault?n.stopPropagation():n.cancelBubble=!0;var r=(o=n.pageX||n.clientX)-s;switch(r>=c&&(r=c),r<=0&&(r=0),a.type){case"half":var w=(r/e).toString().split(".")[1];void 0!==w?1*w.substr(0,1)>5?a.init.wid=e*Math.ceil(r/e):a.init.wid=e*Math.ceil(r/e)-e/2:a.init.wid=e*Math.round(r/e),a.scoleval=a.init.wid/d,a.init.val=a.scoleval<a.init.totalscole?a.scoleval:a.init.totalscole,i.style.width=(a.init.wid<=a.init.totalwid?a.init.wid:a.init.totalwid)+"px";break;case"all":a.init.wid=e*Math.ceil(r/e),a.scoleval=a.init.wid/d,a.init.val=a.scoleval<a.init.totalscole?a.scoleval:a.init.totalscole,i.style.width=(a.init.wid<=a.init.totalwid?a.init.wid:a.init.totalwid)+"px";break;default:a.init.wid=r,a.scoleval=r/d,a.init.val=a.scoleval<a.init.totalscole?a.scoleval:a.init.totalscole,i.style.width=(r<=a.init.totalwid?r:a.init.totalwid)+"px"}"function"==typeof a.callback&&a.callback(a.init,l)},document.onmouseup=function(t){document.onmousemove=null,console.log("document.onmouseup",a.moveflag);var n=window.event||t,o=(n.pageX||n.clientX)-s;switch(a.type){case"half":var c=(o/e).toString().split(".")[1];void 0!==c?1*c.substr(0,1)>5?a.init.wid=e*Math.ceil(o/e):a.init.wid=e*Math.ceil(o/e)-e/2:a.init.wid=e*Math.round(o/e),a.scoleval=a.init.wid/d,a.init.val=a.scoleval<=a.init.totalscole?a.scoleval:a.init.totalscole,i.style.width=(a.init.wid<=a.init.totalwid?a.init.wid:a.init.totalwid)+"px";break;case"all":a.init.wid=e*Math.ceil(o/e),a.scoleval=a.init.wid/d,a.init.val=a.scoleval<=a.init.totalscole?a.scoleval:a.init.totalscole,i.style.width=(a.init.wid<=a.init.totalwid?a.init.wid:a.init.totalwid)+"px";break;default:a.init.wid=o,a.scoleval=o/d,a.init.val=a.scoleval<=a.init.totalscole?a.scoleval:a.init.totalscole,i.style.width=(o<=a.init.totalwid?o:a.init.totalwid)+"px"}"function"==typeof a.callback&&a.callback(a.init,l),a.moveflag=!1,console.log("document.onmouseup----after",a.moveflag),document.onmouseup=null}}}},{key:"touchStart",value:function(t){var i=window.event||t;i.preventDefault(),i.stopPropagation(),window.touch=i.touches[0];var e=Number(touch.pageX);this.cfg.PstartX=e,this.cfg.PlastX=e,this.cfg.PonepxToscole=this.cfg.init.totalwid/this.cfg.init.totalscole,this.cfg.Pdowninitx=this.cfg.init.wid,this.cfg.Pitemoffsetx=this.getoffset(this.cfg.Pitem).left,this.cfg.Pmflag=!1,this.cfg.scoleval=0,this.cfg.starwid=this.cfg.init.totalwid/this.cfg.init.starnum}},{key:"touchMove",value:function(t){var i=window.event||t,e=this.cfg;i.preventDefault(),i.stopPropagation(),e.Pmflag=!0;var l=i.touches[0];e.PlastX=Number(l.pageX);var a=e.PlastX-e.Pitemoffsetx;switch(a>=e.init.totalwid&&(a=e.init.totalwid),a<=0&&(a=0),e.type){case"half":var n=(a/e.starwid).toString().split(".")[1];void 0!==n?1*n.substr(0,1)>5?e.init.wid=e.starwid*Math.ceil(a/e.starwid):e.init.wid=e.starwid*Math.ceil(a/e.starwid)-e.starwid/2:e.init.wid=e.starwid*Math.round(a/e.starwid),e.scoleval=e.init.wid/e.PonepxToscole,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,e.PstarbgObj.style.width=(e.init.wid<e.init.totalwid?e.init.wid:e.init.totalwid)+"px";break;case"all":e.init.wid=e.starwid*Math.ceil(a/e.starwid),e.scoleval=e.init.wid/e.PonepxToscole,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,e.PstarbgObj.style.width=(e.init.wid<e.init.totalwid?e.init.wid:e.init.totalwid)+"px";break;default:e.init.wid=a,e.scoleval=a/e.PonepxToscole,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,e.PstarbgObj.style.width=(a<e.init.totalwid?a:e.init.totalwid)+"px"}}},{key:"touchEnd",value:function(t){var i=window.event||t,e=this.cfg;i.preventDefault(),i.stopPropagation();var l=e.PlastX-e.Pitemoffsetx;switch(l>=e.init.totalwid&&(l=e.init.totalwid),l<=0&&(l=0),e.type){case"half":var a=(l/e.starwid).toString().split(".")[1];void 0!==a?1*a.substr(0,1)>5?e.init.wid=e.starwid*Math.ceil(l/e.starwid):e.init.wid=e.starwid*Math.ceil(l/e.starwid)-e.starwid/2:e.init.wid=e.starwid*Math.round(l/e.starwid),e.scoleval=e.init.wid/e.PonepxToscole,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,e.PstarbgObj.style.width=(e.init.wid<e.init.totalwid?e.init.wid:e.init.totalwid)+"px";break;case"all":e.init.wid=e.starwid*Math.ceil(l/e.starwid),e.scoleval=e.init.wid/e.PonepxToscole,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,e.PstarbgObj.style.width=(e.init.wid<e.init.totalwid?e.init.wid:e.init.totalwid)+"px";break;default:e.init.wid=l,e.scoleval=l/e.PonepxToscole,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,e.PstarbgObj.style.width=(l<e.init.totalwid?l:e.init.totalwid)+"px"}e.Pmflag=!1,"function"==typeof e.callback&&e.callback(e.init,this)}},{key:"onchange",value:function(t){console.log(t);var i=this,e=this.cfg,l=this.cfg.init.totalwid/this.cfg.init.totalscole,a=this.getId(this.cfg.starid).querySelector(i.cfg.starbg),n=l*t,o=this.cfg.init.totalwid/this.cfg.init.starnum;switch(e.type){case"half":var s=(n/o).toString().split(".")[1];void 0!==s?1*s.substr(0,1)>5?e.init.wid=o*Math.ceil(n/o):e.init.wid=o*Math.ceil(n/o)-o/2:e.init.wid=o*Math.round(n/o),e.scoleval=e.init.wid/l,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,a.style.width=(e.init.wid<=e.init.totalwid?e.init.wid:e.init.totalwid)+"px";break;case"all":e.init.wid=o*Math.ceil(n/o),e.scoleval=e.init.wid/l,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,a.style.width=(e.init.wid<=e.init.totalwid?e.init.wid:e.init.totalwid)+"px";break;default:e.init.wid=n,e.scoleval=n/l,e.init.val=e.scoleval<=e.init.totalscole?e.scoleval:e.init.totalscole,a.style.width=(n<=e.init.totalwid?n:e.init.totalwid)+"px"}}}]),t}();
export function CFCMScole(param, fn) {
		return new CFCMScole(param, fn)
	}