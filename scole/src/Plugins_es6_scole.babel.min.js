"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},_createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),CFCMScole=function(){function t(i){_classCallCheck(this,t),this.initVal(i)}return _createClass(t,[{key:"getId",value:function(t){return document.getElementById(t)}},{key:"getClassAll",value:function(t){return document.querySelectorAll(t)}},{key:"remove",value:function(t){var i=t.parentNode;i&&i.removeChild(t)}},{key:"parents",value:function(t,i){return t.className==i?t:(t=t.parentNode,this.parents(t,i))}},{key:"initVal",value:function(t,i){var e={starid:"star0",star:".star",starbg:".starbg",init:{starnum:5,wid:0,val:0,totalscole:100,totalwid:100},callback:!1,disabled:!1,type:"auto",backgroundsize:!1};this.cfg={},_extends(this.cfg,e,t),this.initCommonVal()}},{key:"initCommonVal",value:function(t){var i=this;if(this.cfg.downflag=!1,this.cfg.moveflag=!1,0==this.getClassAll(this.cfg.star).length)return console.log("该页面没有评分项"),!1;var e=0;t?(this.cfg.init.wid=t.init.wid,this.cfg.init.val=t.init.val,this.cfg.init.starnum=t.init.starnum,e=t.init.totalwid/t.init.starnum):(void 0==this.cfg.init.wid?this.cfg.init.wid=0:this.cfg.init.wid=this.cfg.init.wid,void 0==this.cfg.init.val?this.cfg.init.val=0:this.cfg.init.val=this.cfg.init.val,void 0==this.cfg.init.starnum?this.cfg.init.starnum=5:this.cfg.init.starnum=this.cfg.init.starnum,e=this.cfg.init.totalwid/this.cfg.init.starnum);var n=this.getId(this.cfg.starid);if(n){var c=n.querySelector(i.cfg.starbg);if(this.cfg.backgroundsize?(n.setAttribute("style","width:"+i.cfg.init.totalwid+"px;background-size:"+e+"px "),c.setAttribute("style","width:"+i.cfg.init.wid+"px;background-size:"+e+"px ")):(n.setAttribute("style","width:"+i.cfg.init.totalwid+"px"),c.setAttribute("style","width:"+i.cfg.init.wid+"px")),this.cfg.disabled)return n.onmousedown=null,!1;navigator.userAgent.match(/(iPhone|Android|iPad|Mobile|uc)/i)?(i.cfg.PstarbgObj=c,i.cfg.Pstarwid=e,i.cfg.Pitem=n,n.addEventListener("touchstart",function(){i.touchStart(i)},!1),n.addEventListener("touchmove",function(){i.touchMove(i)},!1),n.addEventListener("touchend",function(){i.touchEnd(i)},!1)):i.pcEvent(n,c,e),"function"==typeof i.cfg.callback&&i.cfg.callback(i.cfg.init,i)}}},{key:"getStyle",value:function(t,i){return window.getComputedStyle?window.getComputedStyle(t,null)[i]:t.currentStyle[i]}},{key:"getoffset",value:function(t,i){if(null==t)return i;i||((i={}).top=0,i.left=0);var e=this.getStyle(t,"position");if("absolute"==e||"relative"==e){if(t.getBoundingClientRect&&null!=navigator.userAgent.toLowerCase().match(/.(msie)/))return i.top+=t.getBoundingClientRect.top,i.left+=t.getBoundingClientRect.left,i;i.top+=t.offsetTop,i.left+=t.offsetLeft}else i.top+=0,i.left+=0;return this.getoffset(t.parentElement,i)}},{key:"pcEvent",value:function(t,i,e){var n=this,c=this.cfg;t.onmousedown=function(t){var s=window.event||t,a=s.pageX||s.clientX,f=0,l=n.getoffset(this).left,g=n.cfg.init.totalwid,o=n.cfg.init.totalwid/n.cfg.init.totalscole,r=n.cfg.init.wid;c.downflag=!0,document.onmousemove=function(t){c.moveflag=!0;var s=window.event||t;s.preventDefault?s.stopPropagation():s.cancelBubble=!0;var l=(f=s.pageX||s.clientX)-a+r;switch(l>=g&&(l=g),l<=0&&(l=0),n.cfg.type){case"half":var d=(l/e).toString().split(".")[1];void 0!==d?1*d.substr(0,1)>5?n.cfg.init.wid=e*Math.ceil(l/e):n.cfg.init.wid=e*Math.ceil(l/e)-e/2:n.cfg.init.wid=e*Math.round(l/e),n.cfg.init.val=n.cfg.init.wid/o,i.style.width=n.cfg.init.wid+"px";break;case"all":n.cfg.init.wid=e*Math.ceil(l/e),n.cfg.init.val=n.cfg.init.wid/o,i.style.width=n.cfg.init.wid+"px";break;default:n.cfg.init.wid=l,n.cfg.init.val=l/o,i.style.width=l+"px"}"function"==typeof n.cfg.callback&&n.cfg.callback(n.cfg.init,n)},document.onmouseup=function(t){if(c.downflag=!1,document.onmousemove=null,!c.moveflag){var s=window.event||t,a=(s.pageX||s.clientX)-l;switch(n.cfg.type){case"half":var f=(a/e).toString().split(".")[1];void 0!==f?1*f.substr(0,1)>5?n.cfg.init.wid=e*Math.ceil(a/e):n.cfg.init.wid=e*Math.ceil(a/e)-e/2:n.cfg.init.wid=e*Math.round(a/e),n.cfg.init.val=n.cfg.init.wid/o,i.style.width=n.cfg.init.wid+"px";break;case"all":n.cfg.init.wid=e*Math.ceil(a/e),n.cfg.init.val=n.cfg.init.wid/o,i.style.width=n.cfg.init.wid+"px";break;default:n.cfg.init.wid=a,n.cfg.init.val=a/o,i.style.width=a+"px"}"function"==typeof n.cfg.callback&&n.cfg.callback(n.cfg.init,n)}c.moveflag=!1,document.onmouseup=null}}}},{key:"touchStart",value:function(t){var i=window.event||t;i.preventDefault(),i.stopPropagation(),window.touch=i.touches[0];var e=Number(touch.pageX);this.cfg.PstartX=e,this.cfg.PlastX=e,this.cfg.PonepxToscole=this.cfg.init.totalwid/this.cfg.init.totalscole,this.cfg.Pdowninitx=this.cfg.init.wid,this.cfg.Pitemoffsetx=this.getoffset(this.cfg.Pitem).left,this.cfg.Pmflag=!1}},{key:"touchMove",value:function(t){var i=window.event||t;i.preventDefault(),i.stopPropagation(),this.cfg.Pmflag=!0;var e=i.touches[0];this.cfg.PlastX=Number(e.pageX);var n=this.cfg.PlastX-this.cfg.PstartX+this.cfg.Pdowninitx;switch(n>=this.cfg.init.totalwid&&(n=this.cfg.init.totalwid),n<=0&&(n=0),this.cfg.type){case"half":var c=(n/this.cfg.starwid).toString().split(".")[1];void 0!==c?1*c.substr(0,1)>5?this.cfg.init.wid=this.cfg.starwid*Math.ceil(n/this.cfg.starwid):this.cfg.init.wid=this.cfg.starwid*Math.ceil(n/this.cfg.starwid)-this.cfg.starwid/2:this.cfg.init.wid=this.cfg.starwid*Math.round(n/this.cfg.starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;case"all":this.cfg.init.wid=this.cfg.starwid*Math.ceil(n/this.cfg.starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;default:this.cfg.init.wid=n,this.cfg.init.val=n/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=n+"px"}}},{key:"touchEnd",value:function(t){var i=window.event||t;if(i.preventDefault(),i.stopPropagation(),this.cfg.Pmflag)this.cfg.Pmflag=!1;else{var e=this.cfg.PlastX-this.cfg.Pitemoffsetx;switch(e>=this.cfg.init.totalwid&&(e=this.cfg.init.totalwid),e<=0&&(e=0),this.cfg.type){case"half":var n=(e/starwid).toString().split(".")[1];void 0!==n?1*n.substr(0,1)>5?this.cfg.init.wid=starwid*Math.ceil(e/starwid):this.cfg.init.wid=starwid*Math.ceil(e/starwid)-starwid/2:this.cfg.init.wid=starwid*Math.round(e/starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;case"all":this.cfg.init.wid=starwid*Math.ceil(e/starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;default:this.cfg.init.wid=e,this.cfg.init.val=e/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=e+"px"}}"function"==typeof this.cfg.callback&&this.cfg.callback(this.cfg.init,this)}},{key:"onchange",value:function(t){console.log(t);var i=this,e=this.cfg.init.totalwid/this.cfg.init.totalscole,n=this.getId(this.cfg.starid).querySelector(i.cfg.starbg),c=e*t;switch(i.cfg.type){case"half":var s=(c/starwid).toString().split(".")[1];void 0!==s?1*s.substr(0,1)>5?i.cfg.init.wid=starwid*Math.ceil(c/starwid):i.cfg.init.wid=starwid*Math.ceil(c/starwid)-starwid/2:i.cfg.init.wid=starwid*Math.round(c/starwid),i.cfg.init.val=i.cfg.init.wid/e,n.style.width=i.cfg.init.wid+"px";break;case"all":i.cfg.init.wid=starwid*Math.ceil(c/starwid),i.cfg.init.val=i.cfg.init.wid/e,n.style.width=i.cfg.init.wid+"px";break;default:i.cfg.init.wid=c,i.cfg.init.val=c/e,n.style.width=c+"px"}}}]),t}();
export function CFCMScole(param, fn) {
		return new CFCMScole(param, fn)
	}