"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},_createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),CFCMScole=function(){function t(i){_classCallCheck(this,t),this.initVal(i)}return _createClass(t,[{key:"getId",value:function(t){return document.getElementById(t)}},{key:"getClassAll",value:function(t){return document.querySelectorAll(t)}},{key:"remove",value:function(t){var i=t.parentNode;i&&i.removeChild(t)}},{key:"parents",value:function(t,i){return t.className==i?t:(t=t.parentNode,this.parents(t,i))}},{key:"initVal",value:function(t,i){var e={starid:"star0",star:".star",starbg:".starbg",init:{starnum:5,wid:0,val:0,totalscole:100,totalwid:100},callback:!1,disabled:!1,type:"auto",backgroundsize:!1};this.cfg={},_extends(this.cfg,e,t),this.initCommonVal()}},{key:"initCommonVal",value:function(){var t=this,i=void 0,e=void 0;if(i=e=this.cfg.flag=!1,0==this.getClassAll(this.cfg.star).length)return console.log("该页面没有评分项"),!1;void 0==this.cfg.init.wid?this.cfg.init.wid=0:this.cfg.init.wid,void 0==this.cfg.init.val?this.cfg.init.val=0:this.cfg.init.val,void 0==this.cfg.init.starnum?this.cfg.init.starnum=5:this.cfg.init.starnum;var n=this.cfg.init.totalwid/this.cfg.init.starnum,c=this.getId(this.cfg.starid),s=c.querySelector(t.cfg.starbg);if(this.cfg.backgroundsize?(c.setAttribute("style","width:"+t.cfg.init.totalwid+"px;background-size:"+n+"px "),s.setAttribute("style","width:"+t.cfg.init.wid+"px;background-size:"+n+"px ")):(c.setAttribute("style","width:"+t.cfg.init.totalwid+"px"),s.setAttribute("style","width:"+t.cfg.init.wid+"px")),this.cfg.disabled)return c.onmousedown=null,!1;navigator.userAgent.match(/(iPhone|Android|iPad|Mobile|uc)/i)?(t.cfg.PstarbgObj=s,t.cfg.Pstarwid=n,t.cfg.Pitem=c,c.addEventListener("touchstart",function(){t.touchStart(t)},!1),c.addEventListener("touchmove",function(){t.touchMove(t)},!1),c.addEventListener("touchend",function(){t.touchEnd(t)},!1)):t.pcEvent(c,i,e,s,n)}},{key:"getStyle",value:function(t,i){return window.getComputedStyle?window.getComputedStyle(t,null)[i]:t.currentStyle[i]}},{key:"getoffset",value:function(t,i){if(null==t)return i;i||((i={}).top=0,i.left=0);var e=this.getStyle(t,"position");if("absolute"==e||"relative"==e){if(t.getBoundingClientRect&&null!=navigator.userAgent.toLowerCase().match(/.(msie)/))return i.top+=t.getBoundingClientRect.top,i.left+=t.getBoundingClientRect.left,i;i.top+=t.offsetTop,i.left+=t.offsetLeft}else i.top+=0,i.left+=0;return this.getoffset(t.parentElement,i)}},{key:"pcEvent",value:function(t,i,e,n,c){var s=this;t.onmousedown=function(t){var a=window.event||t;a.preventDefault?(a.preventDefault(),a.stopPropagation()):a.cancelBubble=!0;var f=a.pageX||a.clientX,l=0,o=s.getoffset(this).left,g=s.cfg.init.totalwid,r=s.cfg.init.totalwid/s.cfg.init.totalscole,d=s.cfg.init.wid;(e=!0)&&(document.onmousemove=function(t){i=!0;var e=window.event||t;e.preventDefault?(e.preventDefault(),e.stopPropagation()):e.cancelBubble=!0;var a=(l=e.pageX||e.clientX)-f+d;switch(a>=g&&(a=g),a<=0&&(a=0),s.cfg.type){case"half":var o=(a/c).toString().split(".")[1];void 0!==o?1*o.substr(0,1)>5?s.cfg.init.wid=c*Math.ceil(a/c):s.cfg.init.wid=c*Math.ceil(a/c)-c/2:s.cfg.init.wid=c*Math.round(a/c),s.cfg.init.val=s.cfg.init.wid/r,n.style.width=s.cfg.init.wid+"px";break;case"all":s.cfg.init.wid=c*Math.ceil(a/c),s.cfg.init.val=s.cfg.init.wid/r,n.style.width=s.cfg.init.wid+"px";break;default:s.cfg.init.wid=a,s.cfg.init.val=a/r,n.style.width=a+"px"}"function"==typeof s.cfg.callback&&s.cfg.callback(s.cfg.init)},document.onmouseup=function(t){e=!1,console.log(123),document.onmousemove=null,i&&(i=!1);var a=window.event||t;a.preventDefault?a.stopPropagation():a.cancelBubble=!0;var f=(a.pageX||a.clientX)-o;switch(s.cfg.type){case"half":var l=(f/c).toString().split(".")[1];void 0!==l?1*l.substr(0,1)>5?s.cfg.init.wid=c*Math.ceil(f/c):s.cfg.init.wid=c*Math.ceil(f/c)-c/2:s.cfg.init.wid=c*Math.round(f/c),s.cfg.init.val=s.cfg.init.wid/r,n.style.width=s.cfg.init.wid+"px";break;case"all":s.cfg.init.wid=c*Math.ceil(f/c),s.cfg.init.val=s.cfg.init.wid/r,n.style.width=s.cfg.init.wid+"px";break;default:s.cfg.init.wid=f,s.cfg.init.val=f/r,n.style.width=f+"px"}"function"==typeof s.cfg.callback&&s.cfg.callback(s.cfg.init),document.onmouseup=null})}}},{key:"touchStart",value:function(t){var i=window.event||t;i.preventDefault(),i.stopPropagation(),window.touch=i.touches[0];var e=Number(touch.pageX);this.cfg.PstartX=e,this.cfg.PlastX=e,this.cfg.PonepxToscole=this.cfg.init.totalwid/this.cfg.init.totalscole,this.cfg.Pdowninitx=this.cfg.init.wid,this.cfg.Pitemoffsetx=this.getoffset(this.cfg.Pitem).left,this.cfg.Pmflag=!1}},{key:"touchMove",value:function(t){var i=window.event||t;i.preventDefault(),i.stopPropagation(),this.cfg.Pmflag=!0;var e=i.touches[0];this.cfg.PlastX=Number(e.pageX);var n=this.cfg.PlastX-this.cfg.PstartX+this.cfg.Pdowninitx;switch(n>=this.cfg.init.totalwid&&(n=this.cfg.init.totalwid),n<=0&&(n=0),this.cfg.type){case"half":var c=(n/this.cfg.starwid).toString().split(".")[1];void 0!==c?1*c.substr(0,1)>5?this.cfg.init.wid=this.cfg.starwid*Math.ceil(n/this.cfg.starwid):this.cfg.init.wid=this.cfg.starwid*Math.ceil(n/this.cfg.starwid)-this.cfg.starwid/2:this.cfg.init.wid=this.cfg.starwid*Math.round(n/this.cfg.starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;case"all":this.cfg.init.wid=this.cfg.starwid*Math.ceil(n/this.cfg.starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;default:this.cfg.init.wid=n,this.cfg.init.val=n/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=n+"px"}}},{key:"touchEnd",value:function(t){var i=window.event||t;if(i.preventDefault(),i.stopPropagation(),this.cfg.Pmflag)this.cfg.Pmflag=!1;else{var e=this.cfg.PlastX-this.cfg.Pitemoffsetx;switch(e>=this.cfg.init.totalwid&&(e=this.cfg.init.totalwid),e<=0&&(e=0),this.cfg.type){case"half":var n=(e/starwid).toString().split(".")[1];void 0!==n?1*n.substr(0,1)>5?this.cfg.init.wid=starwid*Math.ceil(e/starwid):this.cfg.init.wid=starwid*Math.ceil(e/starwid)-starwid/2:this.cfg.init.wid=starwid*Math.round(e/starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;case"all":this.cfg.init.wid=starwid*Math.ceil(e/starwid),this.cfg.init.val=this.cfg.init.wid/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=this.cfg.init.wid+"px";break;default:this.cfg.init.wid=e,this.cfg.init.val=e/this.cfg.PonepxToscole,this.cfg.PstarbgObj.style.width=e+"px"}}"function"==typeof this.cfg.callback&&this.cfg.callback(this.cfg.init)}},{key:"onchange",value:function(t){console.log(t);var i=this,e=this.cfg.init.totalwid/this.cfg.init.totalscole,n=this.getId(this.cfg.starid).querySelector(i.cfg.starbg),c=e*t;switch(i.cfg.type){case"half":var s=(c/starwid).toString().split(".")[1];void 0!==s?1*s.substr(0,1)>5?i.cfg.init.wid=starwid*Math.ceil(c/starwid):i.cfg.init.wid=starwid*Math.ceil(c/starwid)-starwid/2:i.cfg.init.wid=starwid*Math.round(c/starwid),i.cfg.init.val=i.cfg.init.wid/e,n.style.width=i.cfg.init.wid+"px";break;case"all":i.cfg.init.wid=starwid*Math.ceil(c/starwid),i.cfg.init.val=i.cfg.init.wid/e,n.style.width=i.cfg.init.wid+"px";break;default:i.cfg.init.wid=c,i.cfg.init.val=c/e,n.style.width=c+"px"}}}]),t}();
export function CFCMScole(param, fn) {
		return new CFCMScole(param, fn)
	}